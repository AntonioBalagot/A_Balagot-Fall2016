package textExcel;

// Update this file with your own code.

public class Spreadsheet implements Grid{
	private Cell[][] spreadsheet;
	public Spreadsheet(){
		spreadsheet = new Cell [20][12];
		for(int i=0; i<20; i++){
			for(int j=0; j<12;j++){
				spreadsheet[i][j] = new EmptyCell();
			}
		}
		
	}

	@Override
	public String processCommand(String command){
		if(command.indexOf(" ") > 0){
			String[] input = command.split(" ", 3);
			if(input.length > 1){
				if(input[1].equals("=")){
					String cellLocation = input[0];
					SpreadsheetLocation loc = new SpreadsheetLocation(cellLocation);
					int column = loc.getCol();
					int row = loc.getRow();
					if (input[2].charAt(0) == '"' && input[2].charAt(input[2].length()-1) == '"'){
						spreadsheet[row][column] = new TextCell(input[2].substring(1, input[2].length()-1));
					} else if (input[2].charAt(0) == '(' && input[2].charAt(input[2].length()-1) == ')'){
						spreadsheet[row][column] = new FormulaCell(input[2]);
					} else if(input[2].substring(input[2].length()-1).equals("%")){
						spreadsheet[row][column] = new PercentCell(input[2]);
					} else
						spreadsheet[row][column] = new ValueCell(input[2]);
				}
				else if (input[0].equalsIgnoreCase("clear")){
					SpreadsheetLocation loc = new SpreadsheetLocation(input[1]);
					spreadsheet[loc.getRow()][loc.getCol()] = new EmptyCell();
					return (getGridText());
				}
			}
		return (getGridText());
	}
	@Override
	public int getRows(){
		return 20;
	}

	@Override
	public int getCols(){
		return 12;
	}

	@Override
	public Cell getCell(Location loc){
		return spreadsheet[];
	}

	@Override
	public String getGridText(){
		String spreadsheet = "";
		String rows = "";
		//Adds the number for each row
		String numberRows = "";
		//Adds the letter for each column
		String addLetters = "  |";
		for(int i=0; i < 12; i++){
			addLetters = addLetters + ((char) ('A' + i)) + "         |";
		}
		spreadsheet = spreadsheet + addLetters + "\n";
		for(int i = 0; i<20;i++){
			//To get equal spacing for the labels
			if (i<9){
				rows = (i+1) + "  |";
			}else{
				rows = (i+1) + " |";
			}
			for(int k = 0; k < cells.length; k++){
				rows = rows + "         |";
			}
			numberRows = "\n";
			spreadsheet = spreadsheet + rows + numberRows;
		}
		return spreadsheet;
	}

}
